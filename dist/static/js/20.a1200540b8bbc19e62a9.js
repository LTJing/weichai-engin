webpackJsonp([20],{GUlH:function(e,t,a){"use strict";a.d(t,"c",function(){return o}),a.d(t,"d",function(){return l}),a.d(t,"b",function(){return s}),a.d(t,"a",function(){return r});var i=a("2aIq"),n=(a.n(i),a("xXZE")),o=function(e){return n.a.request({url:"/order/getDevice",params:e,method:"get"})},l=function(e){return n.a.request({url:"/device/editDevice",data:e,method:"post"})},s=function(e){return n.a.request({url:"/device/delDevice",data:e,method:"post"})},r=function(e){return n.a.request({url:"/device/addDevice",data:e,method:"post"})}},KcdW:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),o=a("Dd8w"),l=a.n(o),s=a("526/"),r=a("jpo7"),c=a("G8pB"),d=a("GUlH"),u=a("xV2B"),f={components:{StatusSelect:s.a,LaboratoryList:r.a,customDrawer:c.a},data:function(){var e=this;return{search:{type:"",name:"",code:""},pageInfo:{loading:!1,pageIndex:1,pageSize:10,totalElements:30},tableData:[],maxlength:50,selectLocation:"",tableColumns:[{title:"设备名称",key:"deviceName",align:"left"},{title:"设备类型",key:"typeName",align:"left"},{title:"设备型号",key:"modelName",align:"left"},{title:"设备编码",key:"deviceCode",align:"left"},{title:"坐标",key:"latitude",align:"left",width:200,render:function(e,t){return t.row.latitude&&t.row.longitude?e("div",t.row.longitude+","+t.row.latitude):""}},{title:"控制场景",key:"deviceControlMode",align:"left",render:function(e,t){if(!t.row.deviceControlMode)return e("div","");switch(t.row.deviceControlMode){case"SINGLE_FCU":return e("div","单机FCU控制");case"ALL_FCU":return e("div","整机FCU控制");case"PCS":return e("div","PCS控制");case"BATTERY":return e("div","电池控制")}}},{title:"操作",key:"action",width:200,align:"left",render:function(t,a){return t("div",[t("span",{class:"primary",style:{marginLeft:0,color:"#0084FF"},on:{click:function(){e.goDetail(a.row)}}},"详情"),t("span",{class:"primary",style:{marginLeft:0,color:"#0084FF"},on:{click:function(){e.showDrawer("edit",a.row)}}},"编辑"),t("span",{class:"primary",style:{marginLeft:0,color:"#F12121"},on:{click:function(){e.showDrawer("delete",a.row)}}},"删除")])}}],currentIndex:0,title:"",formList:[{label:"设备名称",type:"input",value:"deviceName"},{label:"设备类型",type:"select",value:"deviceType",data:[]},{label:"设备型号",type:"select",value:"deviceModel",data:[]},{label:"设备编码",type:"input",value:"deviceCode",data:[]},{label:"坐标",type:"locationSelect",value:"addrCode",placeholder:"请选择坐标"},{label:"父级设备",type:"select",value:"parentDeviceId",placeholder:"请选择父级设备",clearable:!0,data:[]},{label:"控制场景",value:"deviceControlMode",type:"radio",data:[{name:"单机FCU控制",value:"SINGLE_FCU"},{name:"整机FCU控制",value:"ALL_FCU"},{name:"PCS控制",value:"PCS"},{name:"电池控制",value:"BATTERY"}]},{label:"关联故障树",value:"accidentTreeId",type:"select",placeholder:"请选择关联故障树",data:[],clearable:!0}],formValue:{},formValidate:{deviceName:[{required:!0,message:"设备名称不能为空"}],deviceType:[{required:!0,message:"设备类型不能为空"}],deviceModel:[{required:!0,message:"设备型号不能为空"}],deviceCode:[{required:!0,message:"设备编码不能为空"}]},type:""}},methods:{selectTree:function(e){this.formValue.addr=e},getlocation:function(e){this.formValue.longitude=e.lng,this.formValue.latitude=e.lat},getType:function(){var e=this;Object(u.z)().then(function(t){var a=t.code,i=t.data;200===a&&(e.formList[0].data=i.map(function(e){return{name:e.deviceName,value:e.deviceName}}))}),Object(u.X)().then(function(t){200===t.code&&(e.formList[7].data=t.data.map(function(e){return{name:e.accidentTreeName,value:e.id}}))}),Object(u.A)().then(function(t){var a=t.code,i=t.data;200===a&&(e.formList[1].data=i.map(function(e){return{name:e.typeName,value:e.id}}))}),Object(u.h)().then(function(t){200===t.code&&(e.formList[2].data=t.data.map(function(e){return{name:e.modelName,value:e.id}}))}),Object(u.L)().then(function(t){200===t.code&&(e.formList[5].data=t.data.map(function(e){return{name:e.deviceName,value:e.deviceId}}))})},loadTableData:function(e){var t=this,a=this.pageInfo,i=a.pageSize,n=a.pageIndex;this.pageInfo.loading=!0,e&&(this.pageInfo.pageIndex=1),Object(d.c)(l()({pageSize:i,pageNumber:n},this.search)).then(function(e){var a=e.code,i=e.data;t.pageInfo.loading=!1,200===a&&(t.tableData=i.result,t.pageInfo.totalElements=i.totalElements)})},goDetail:function(e){this.$router.push({path:"/device-list-detail",query:{id:e.id,deviceName:e.deviceName,treeId:e.accidentTreeId||""}})},showDrawer:function(e,t){var a=this;if("delete"!==e){if("add"===e)this.title="新建设备",this.formValue={},this.selectLocation="",this.formValue.longitude="",this.formValue.latitude="";else{var i=JSON.parse(n()(t));this.title="编辑设备",this.formValue=i,this.formValue.deviceType=i.deviceTypeId,this.formValue.parentDeviceId=Number(i.parentDeviceId),i.longitude&&i.latitude?this.selectLocation=i.longitude+","+i.latitude:(this.selectLocation="",this.formValue.longitude="",this.formValue.latitude="")}this.type=e,this.$refs.drawer.open()}else this.$Modal.confirm({title:this.$t("common.text.prompt"),width:this.$flexible(450),content:this.$t("common.text.confirm_title",{name:"设备名称"})+"["+t.deviceName+"]的设备吗?",onOk:function(){Object(d.b)({id:t.id}).then(function(e){200===e.code?(a.$Message.success(e.msg),a.loadTableData()):a.$Message.warning(e.msg)},function(e){a.$Message.warning(e.msg)})}})},onRowClick:function(){},onPaginationChange:function(e){this.pageInfo.pageIndex=e,this.loadTableData(!1)},onPaginationSizeChange:function(e){this.pageInfo.pageSize=e,this.loadTableData(!0)},rowClassName:function(e,t){if(e.id==this.currentIndex)return"demo-table-info-row"},confirm:function(){var e=this;console.log(this.formValue),this.formValue.state=this.formValue.deviceStatus,"edit"===this.type?Object(d.d)(l()({},this.formValue)).then(function(t){var a=t.code,i=t.msg;200===a?(e.$Message.success(e.$t("common.message.edit_success")),e.loadTableData(),e.$refs.drawer.close(),e.getType()):e.$Message.warning(i)}):Object(d.a)(l()({},this.formValue)).then(function(t){var a=t.code,i=t.msg;200===a?(e.$Message.success(e.$t("common.message.add_success")),e.loadTableData(),e.getType(),e.$refs.drawer.close()):e.$Message.warning(i)})}},mounted:function(){this.loadTableData(),this.getType()}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list"},[a("div",{staticClass:"content"},[e._m(0),e._v(" "),a("div",{staticClass:"filter-search"},[a("div",{staticClass:"filter-search-left"},[a("div",{staticClass:"filter-select mr-12"},[a("StatusSelect",{attrs:{placeholder:"选择设备类型",filterable:!0,type:1},model:{value:e.search.type,callback:function(t){e.$set(e.search,"type",t)},expression:"search.type"}})],1),e._v(" "),a("div",{staticClass:"filter-select mr-12"},[a("StatusSelect",{attrs:{placeholder:"选择设备名称",filterable:!0,type:2},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),e._v(" "),a("div",{staticClass:"filter-select mr-12"},[a("StatusSelect",{attrs:{placeholder:"选择设备编号",filterable:!0,type:3},model:{value:e.search.code,callback:function(t){e.$set(e.search,"code",t)},expression:"search.code"}})],1),e._v(" "),a("div",{staticClass:"filter-btn"},[a("Button",{attrs:{type:"default",loading:e.pageInfo.loading},on:{click:function(t){e.loadTableData()}}},[a("span",{staticClass:"iconfont icon-chazhao"})])],1)]),e._v(" "),a("div",{staticClass:"filter-search-right"},[a("span",{staticClass:"add-btn"},[a("Button",{attrs:{type:"default"},on:{click:function(t){e.showDrawer("add")}}},[a("span",{staticClass:"iconfont icon-a-lianhe68"}),e._v("\n            新增\n          ")])],1)])]),e._v(" "),a("div",{staticClass:"user-table"},[a("Table",{staticClass:"m-table no-scroll no-border",attrs:{stripe:"",loading:e.pageInfo.loading,columns:e.tableColumns,"row-class-name":e.rowClassName,data:e.tableData},on:{"on-row-click":e.onRowClick}})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{current:e.pageInfo.pageIndex,"page-size":e.pageInfo.pageSize,total:e.pageInfo.totalElements,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.onPaginationChange,"on-page-size-change":e.onPaginationSizeChange}})],1),e._v(" "),a("custom-drawer",{ref:"drawer",attrs:{width:"26%",title:e.title,formValidate:e.formValidate,formList:e.formList,selectLocation:e.selectLocation},on:{selectTree:e.selectTree,getlocation:e.getlocation,confirm:e.confirm},model:{value:e.formValue,callback:function(t){e.formValue=t},expression:"formValue"}})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header-sub"},[t("div",{staticClass:"title"},[t("div",{staticClass:"breadcrumb-item-link"},[this._v("设备维护")]),this._v(" "),t("span",{staticClass:"empty"})])])}]};var h=a("VU/8")(f,m,!1,function(e){a("yrv0")},"data-v-90b765cc",null).exports;t.default=h},yrv0:function(e,t){}});
//# sourceMappingURL=20.a1200540b8bbc19e62a9.js.map