webpackJsonp([9],{"2vaj":function(e,t){},"4dfI":function(e,t){},"9yX7":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("RWfK"),i=a("526/"),o=a("jpo7"),s=a("xV2B"),l={components:{StatusSelect:i.a,LaboratoryList:o.a},data:function(){return{pageInfo:{loading:!1,pageIndex:1,pageSize:10,totalElements:30},tableData:[],maxlength:50,selectLocation:"",tableColumns:[{title:"设备名称",key:"deviceName",align:"left"},{title:"设备类型",key:"typeName",align:"left"},{title:"设备型号",key:"modelName",align:"left"},{title:"设备编码",key:"deviceCode",align:"left"},{title:"坐标",key:"latitude",align:"left",width:200,render:function(e,t){return t.row.latitude&&t.row.longitude?e("div",t.row.longitude+","+t.row.latitude):""}},{title:"孪生模型",key:"twinModel",align:"left"},{title:"健康诊断模型",key:"healthDiagnosisModel",align:"left"}],currentIndex:0,title:"",type:""}},computed:{deviceName:function(){return this.$route.query.deviceName}},methods:{back:function(){this.$router.push({name:"device-checklist"})},getlocation:function(e){this.formValue.longitude=e.lng,this.formValue.latitude=e.lat},loadTableData:function(e){var t=this,a=this.$route.query.id;this.pageInfo.loading=!0,e&&(this.pageInfo.pageIndex=1);var n=this.pageInfo,i=n.pageIndex,o=n.pageSize;Object(s.s)({id:a,pageNumber:i,pageSize:o}).then(function(e){var a=e.code,n=e.data;t.pageInfo.loading=!1,200===a&&(t.tableData=n.data.result,t.pageInfo.totalElements=n.data.totalElements)})},onRowClick:function(){},onPaginationChange:function(e){this.pageInfo.pageIndex=e,this.loadTableData(!1)},onPaginationSizeChange:function(e){this.pageInfo.pageSize=e,this.loadTableData(!0)},rowClassName:function(e,t){if(e.id==this.currentIndex)return"demo-table-info-row"}},mounted:function(){this.loadTableData()}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list"},[a("div",{staticClass:"content"},[a("div",{staticClass:"header-sub"},[a("div",{staticClass:"title"},[a("div",{staticClass:"breadcrumb-item-link"},[e._v("设备详情")]),e._v(" "),a("span",{staticClass:"empty"}),e._v(" "),a("Button",{staticStyle:{width:"80px"},attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)]),e._v(" "),a("div",{staticClass:"title"},[e._v("\n      "+e._s("名称："+e.deviceName)+"\n    ")]),e._v(" "),a("div",{staticClass:"user-table"},[a("Table",{staticClass:"m-table no-scroll no-border",attrs:{stripe:"",loading:e.pageInfo.loading,columns:e.tableColumns,"row-class-name":e.rowClassName,data:e.tableData},on:{"on-row-click":e.onRowClick}})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{current:e.pageInfo.pageIndex,"page-size":e.pageInfo.pageSize,total:e.pageInfo.totalElements,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.onPaginationChange,"on-page-size-change":e.onPaginationSizeChange}})],1)])])},staticRenderFns:[]};var c=a("VU/8")(l,r,!1,function(e){a("aS6l")},"data-v-50a637b8",null).exports,d={components:{StatusSelect:i.a,LaboratoryList:o.a},data:function(){return{tableData:[],maxlength:50,listStyle:{width:"45%",height:.3*document.body.clientWidth+"px"},targetKeys:[],allPoints:[],deviceName:"",loading:!0}},mounted:function(){this.loadTableData(),this.getTargetKeys(),this.deviceName=this.$route.query.deviceName},computed:{id:function(){return this.$route.query.id}},methods:{back:function(){this.$router.push({name:"device-checklist"})},getTargetKeys:function(){var e=this;Object(s.P)({id:this.id}).then(function(t){200===t.code&&(e.targetKeys=t.data.map(function(e){return e.itemName}))})},handleChange:function(e){this.targetKeys=e},render3:function(e){return e.label},reloadMockData:function(){this.loadTableData(),this.getTargetKeys()},onPaginationChange:function(e){this.pageInfo.pageIndex=e,this.loadTableData(!1)},onPaginationSizeChange:function(e){this.pageInfo.pageSize=e,this.loadTableData(!0)},loadTableData:function(e){var t=this;this.loading=!0,e&&(this.pageInfo.pageIndex=1),Object(s.O)({}).then(function(e){200===e.code&&(t.allPoints=e.data.map(function(e){return{label:(e.alias||"")+e.itemName,key:e.itemName}}),t.loading=!1)})},confirm:function(){var e=this;Object(s.i)({deviceId:this.id,itemIds:this.targetKeys}).then(function(t){200===t.code?e.$Message.success("更新成功"):e.$Message.warning(t.msg)})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list"},[a("div",{staticClass:"content"},[a("div",{staticClass:"header-sub"},[a("div",{staticClass:"title"},[a("div",{staticClass:"breadcrumb-item-link"},[e._v("设备详情")]),e._v(" "),a("span",{staticClass:"empty"}),e._v(" "),a("Button",{staticStyle:{width:"80px"},attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)]),e._v(" "),a("div",{staticClass:"title"},[e._v("\n      "+e._s("名称："+e.deviceName)+"\n    ")]),e._v(" "),a("div",[a("Transfer",{attrs:{data:e.allPoints,"target-keys":e.targetKeys,"list-style":e.listStyle,"render-format":e.render3,operations:["移除","添加"],filterable:"",loading:e.loading,titles:["可选测点","已添加的测点"]},on:{"on-change":e.handleChange}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"24px",display:"flex","justify-content":"center"}},[a("Button",{staticStyle:{width:"80px"},on:{click:e.confirm}},[e._v("确定")])],1)])])},staticRenderFns:[]};var g=a("VU/8")(d,u,!1,function(e){a("2vaj")},"data-v-197b1b56",null).exports,m={components:{StatusSelect:i.a,LaboratoryList:o.a},data:function(){return{pageInfo:{loading:!1,pageIndex:1,pageSize:10,totalElements:30},tableData:[],maxlength:50,selectLocation:"",tableColumns:[{title:"设备名称",key:"deviceName",align:"left"},{title:"设备类型",key:"typeName",align:"left"},{title:"设备型号",key:"modelName",align:"left"},{title:"设备编码",key:"deviceCode",align:"left"},{title:"控制场景",key:"deviceControlMode",align:"left",render:function(e,t){if(!t.row.deviceControlMode)return e("div","");switch(t.row.deviceControlMode){case"SINGLE_FCU":return e("div","单机FCU控制");case"ALL_FCU":return e("div","整机FCU控制");case"PCS":return e("div","PCS控制");case"BATTERY":return e("div","电池控制")}}},{title:"坐标",key:"latitude",align:"left",width:200,render:function(e,t){return t.row.latitude&&t.row.longitude?e("div",t.row.longitude+","+t.row.latitude):""}}],currentIndex:0,title:"",type:""}},computed:{deviceName:function(){return this.$route.query.deviceName}},methods:{back:function(){this.$router.push({name:"device-checklist"})},getlocation:function(e){this.formValue.longitude=e.lng,this.formValue.latitude=e.lat},loadTableData:function(e){var t=this,a=this.$route.query.id;this.pageInfo.loading=!0,e&&(this.pageInfo.pageIndex=1);var n=this.pageInfo,i=n.pageIndex,o=n.pageSize;Object(s.B)({id:a,pageNumber:i,pageSize:o}).then(function(e){var a=e.code,n=e.data;t.pageInfo.loading=!1,200===a&&(t.tableData=n.result,t.pageInfo.totalElements=n.totalElements)})},onRowClick:function(){},onPaginationChange:function(e){this.pageInfo.pageIndex=e,this.loadTableData(!1)},onPaginationSizeChange:function(e){this.pageInfo.pageSize=e,this.loadTableData(!0)},rowClassName:function(e,t){if(e.id==this.currentIndex)return"demo-table-info-row"}},mounted:function(){this.loadTableData()}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list"},[a("div",{staticClass:"content"},[a("div",{staticClass:"header-sub"},[a("div",{staticClass:"title"},[a("div",{staticClass:"breadcrumb-item-link"},[e._v("设备详情")]),e._v(" "),a("span",{staticClass:"empty"}),e._v(" "),a("Button",{staticStyle:{width:"80px"},attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)]),e._v(" "),a("div",{staticClass:"title"},[e._v("\n      "+e._s("名称："+e.deviceName)+"\n    ")]),e._v(" "),a("div",{staticClass:"user-table"},[a("Table",{staticClass:"m-table no-scroll no-border",attrs:{stripe:"",loading:e.pageInfo.loading,columns:e.tableColumns,"row-class-name":e.rowClassName,data:e.tableData},on:{"on-row-click":e.onRowClick}})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{current:e.pageInfo.pageIndex,"page-size":e.pageInfo.pageSize,total:e.pageInfo.totalElements,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.onPaginationChange,"on-page-size-change":e.onPaginationSizeChange}})],1)])])},staticRenderFns:[]};var h=a("VU/8")(m,f,!1,function(e){a("4dfI")},"data-v-5abaea5b",null).exports,v=a("Dd8w"),p=a.n(v),b=a("mvHQ"),y=a.n(b),C=a("G8pB"),w={components:{StatusSelect:i.a,LaboratoryList:o.a,customDrawer:C.a},data:function(){var e=this;return{accidentTreeId:"",typeList:[],pageInfo:{loading:!1,pageIndex:1,pageSize:10,totalElements:30},tableData:[],maxlength:50,selectLocation:"",tableColumns:[{title:"规则名称",key:"ruleName",align:"left"},{title:"关联测点",key:"itemCode",align:"left"},{title:"判断符号",key:"conditionSymbol",align:"left",render:function(e,t){var a="";switch(t.row.conditionSymbol){case"EQUAL":a="等于";break;case"EQUAL_AND_MORE":a="大于等于";break;case"LESS":a="小于";break;case"EQUAL_AND_LESS":a="小于等于";break;case"MORE":a="大于"}return e("div",a)}},{title:"阈值",key:"conditionValue",align:"left"},{title:"报警内容",key:"alarmContent",align:"left"},{title:"是否启用",key:"state",align:"left",render:function(e,t){return e("div","ON"===t.row.state?"是":"否")}},{title:"故障代码",key:"engRuleName",align:"left"},{title:"操作",key:"action",width:200,align:"left",render:function(t,a){return t("div",[t("span",{class:"primary",style:{marginLeft:0,color:"#0084FF"},on:{click:function(){e.showDrawer("edit",a.row)}}},"编辑"),t("span",{class:"primary",style:{marginLeft:0,color:"#0084FF"},on:{click:function(){e.showDrawer("delete",a.row)}}},"删除")])}}],currentIndex:0,title:"",type:"",formList:[{label:"规则名称",type:"input",value:"ruleName"},{label:"测点",type:"input",value:"itemCode"},{label:"范围",type:"select",value:"conditionSymbol",data:[{name:"等于",value:"EQUAL"},{name:"大于等于",value:"EQUAL_AND_MORE"},{name:"小于",value:"LESS"},{name:"小于等于",value:"EQUAL_AND_LESS"},{name:"大于",value:"MORE"}]},{label:"阈值",type:"input",value:"conditionValue"},{label:"报警内容",type:"textarea",value:"alarmContent"},{label:"故障代码",type:"input",value:"engRuleName"},{label:"是否启用",type:"switch",value:"state"}],formValue:{},formValidate:{conditionSymbol:[{required:!0,message:"范围不能为空"}],itemCode:[{required:!0,message:"测点不能为空"}],conditionValue:[{required:!0,message:"阈值不能为空"}],ruleName:[{required:!0,message:"规则名称不能为空"}],alarmContent:[{required:!0,message:"报警内容不能为空"}]}}},computed:{deviceName:function(){return this.$route.query.deviceName}},methods:{getTree:function(){var e=this;Object(s.X)().then(function(t){200===t.code&&(e.typeList=t.data.map(function(e){return{name:e.accidentTreeName,value:e.id}}),""===e.accidentTreeId&&(e.accidentTreeId=e.typeList[0].value))})},showDrawer:function(e,t){var a=this;if("delete"!==e){if("add"===e)this.title="新建",this.formValue={},this.formValue.state="ON";else{var n=JSON.parse(y()(t));this.title="编辑",this.formValue=n}this.type=e,this.$refs.drawer.open()}else this.$Modal.confirm({title:this.$t("common.text.prompt"),width:this.$flexible(450),content:this.$t("common.text.confirm_title",{name:"关联测点"})+"["+t.itemCode+"]的规则吗?",onOk:function(){Object(s.g)({id:t.id}).then(function(e){200===e.code?(a.$Message.success("删除成功"),a.loadTableData()):a.$Message.warning(e.msg)},function(e){a.$Message.warning(e.msg)})}})},confirm:function(){var e=this,t=this.$route.query.id;"edit"===this.type?Object(s._7)(p()({},this.formValue,{deviceId:t})).then(function(t){var a=t.code,n=t.msg;200===a?(e.$Message.success(e.$t("common.message.edit_success")),e.loadTableData(),e.$refs.drawer.close()):e.$Message.warning(n)}):Object(s.d)(p()({},this.formValue,{deviceId:t})).then(function(t){var a=t.code,n=t.msg;200===a?(e.$Message.success(e.$t("common.message.add_success")),e.loadTableData(),e.$refs.drawer.close()):e.$Message.warning(n)})},back:function(){this.$router.push({name:"device-checklist"})},getlocation:function(e){this.formValue.longitude=e.lng,this.formValue.latitude=e.lat},loadTableData:function(e){var t=this,a=this.$route.query.treeId,n=this.$route.query.id;this.accidentTreeId=a||"",this.pageInfo.loading=!0,e&&(this.pageInfo.pageIndex=1);var i=this.pageInfo,o=i.pageIndex,l=i.pageSize;Object(s.U)({deviceId:n,pageNumber:o,pageSize:l}).then(function(e){var a=e.code,n=e.data;t.pageInfo.loading=!1,200===a&&(t.tableData=n.result,t.pageInfo.totalElements=n.totalElements)})},onRowClick:function(){},onPaginationChange:function(e){this.pageInfo.pageIndex=e,this.loadTableData(!1)},onPaginationSizeChange:function(e){this.pageInfo.pageSize=e,this.loadTableData(!0)},rowClassName:function(e,t){if(e.id==this.currentIndex)return"demo-table-info-row"}},mounted:function(){this.loadTableData(),this.getTree()}},I={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list"},[a("div",{staticClass:"content"},[a("div",{staticClass:"header-sub"},[a("div",{staticClass:"title"},[a("div",{staticClass:"breadcrumb-item-link"},[e._v("设备详情")]),e._v(" "),a("span",{staticClass:"empty"}),e._v(" "),a("Button",{staticStyle:{width:"80px"},attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)]),e._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticClass:"title"},[e._v("\n        "+e._s("名称："+e.deviceName)+"\n      ")]),e._v(" "),a("div",{staticClass:"filter-search-right"},[a("span",{staticClass:"t-btn"},[a("Button",{on:{click:function(t){e.showDrawer("add")}}},[a("span",{staticClass:"iconfont icon-a-lianhe68"}),e._v("\n            新增\n          ")])],1)])]),e._v(" "),a("div",{staticClass:"user-table"},[a("Table",{staticClass:"m-table no-scroll no-border",attrs:{stripe:"",loading:e.pageInfo.loading,columns:e.tableColumns,"row-class-name":e.rowClassName,data:e.tableData},on:{"on-row-click":e.onRowClick}})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{current:e.pageInfo.pageIndex,"page-size":e.pageInfo.pageSize,total:e.pageInfo.totalElements,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.onPaginationChange,"on-page-size-change":e.onPaginationSizeChange}})],1)]),e._v(" "),a("custom-drawer",{ref:"drawer",attrs:{title:e.title,formValidate:e.formValidate,formList:e.formList},on:{confirm:e.confirm},model:{value:e.formValue,callback:function(t){e.formValue=t},expression:"formValue"}})],1)},staticRenderFns:[]};var _=a("VU/8")(w,I,!1,function(e){a("xoEz")},"data-v-bb6b3cc0",null).exports,k=a("CCvC"),S={name:"device-list-detail",components:{tab:n.a,deviceGroupManage:h,devicePointManage:g},mixins:[k.a],data:function(){return{tabList:[{id:1,name:"机组配置",com:h},{id:2,name:"测点配置",com:g},{id:3,name:"控制配置",com:c},{id:4,name:"规则配置",com:_}],tabIndex:0,is:null}},created:function(){this.is=this.tabList[this.tabIndex].com},methods:{changeTab:function(e){this.tabIndex=e,this.is=this.tabList[e].com}}},x={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"platform"},[t("tab",{attrs:{data:this.tabList,current:this.tabIndex},on:{change:this.changeTab}}),this._v(" "),t("div",{staticClass:"content"},[t("transition",{attrs:{"enter-active-class":this.routerTransitionClass.enter,"leave-active-class":this.routerTransitionClass.leave}},[t(this.is,{tag:"component"})],1)],1)],1)},staticRenderFns:[]};var N=a("VU/8")(S,x,!1,function(e){a("WqOO")},"data-v-16aa0cea",null);t.default=N.exports},WqOO:function(e,t){},aS6l:function(e,t){},xoEz:function(e,t){}});
//# sourceMappingURL=9.0901b9c2fbdbd00d0270.js.map