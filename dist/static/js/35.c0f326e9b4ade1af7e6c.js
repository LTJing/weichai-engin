webpackJsonp([35],{"1I6r":function(t,e){},"8EBw":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),s=a.n(i),n=a("qgvZ"),c=a("xV2B"),l=a("PJh5"),o=a.n(l),d={name:"real-time-statistics",components:{ChartBase:n.a},data:function(){return{chartOption:{},search:{name:"",status:""},currentId:"",rangeTime:[o()().subtract(1,"days").format("YYYY-MM-DD HH:mm:ss"),o()().format("YYYY-MM-DD HH:mm:ss")],tableColumns:[{title:this.$t_p("device_name"),key:"deviceName",align:"center"},{title:this.$t("common.text.device_code"),key:"deviceCode",align:"center"},{title:this.$t("common.text.device_model"),key:"modelName",align:"center"},{title:this.$t("common.text.device_state"),key:"deviceStatusName",align:"center",render:function(t,e){return t("span",{class:1==e.row.deviceStatus?"success":"warning"},e.row.deviceStatusName)}}],deviceId:"",tableData:[],deviceName:[],realData:[],clicked:0,pageInfo:{loading:!1,pageIndex:1,pageSize:1e4,totalElements:0}}},watch:{deviceId:function(t){this.itemIds=[],this.chartOption={},this.loadRealData()}},methods:{clickLi:function(t,e){this.clicked=e,this.deviceId=t.id},checkDate:function(t){var e=this;t.checked=!t.checked,t.checked?(this.itemIds.push(t.itemId),this.deviceName.push(t.alias)):this.itemIds.map(function(a,i){t.itemId==a&&(e.itemIds.splice(i,1),e.deviceName.splice(i,1))})},checkItemId:function(t){t.checked=!t.checked,console.log(t),this.currentId=t.itemId,this.itemIds=[],this.itemIds.push(t.itemId)},loadRealData:function(){var t=this;Object(c.F)({id:this.deviceId}).then(function(e){t.realData=(e.data||[]).map(function(t){return s()({},t,{checked:!1})})})},loadLineData:function(){var t=this,e=this.rangeTime[0]&&o()(o()(this.rangeTime[0])).format("YYYY-MM-DD HH:mm:ss"),a=this.rangeTime[1]&&o()(o()(this.rangeTime[1])).format("YYYY-MM-DD HH:mm:ss");this.itemIds.length>0&&""!=e&&""!=a?(this.pageInfo.loading=!0,Object(c._3)({deviceId:this.deviceId,itemIds:this.itemIds.toString(),sDate:e,eDate:a}).then(function(e){if(e.data){var a=e.data.dataTime,i=(e.data.lines||[]).map(function(t){return s()({},t,{smooth:!1})});t.line(a,i,t.deviceName)}t.pageInfo.loading=!1})):0==this.itemIds.length?this.$Message.warning("该设备没有匹配的信息"):""!=e&&""!=a||this.$Message.warning("该时间段没有匹配的信息")},rgb:function(){var t="("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")";return t},color:function(){var t=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),a=Math.floor(256*Math.random()),i="#"+t.toString(16)+e.toString(16)+a.toString(16);return i},line:function(t,e,a){this.chartOption={grid:{x:80,y:20,x2:80,y2:50,containLabel:!0},tooltip:{trigger:"axis"},color:["rgba(0, 132, 255, 1)","#87cefa","#da70d6","#32cd32","#6495ed","#ff69b4","#ba55d3","#cd5c5c","#ffa500","#40e0d0","#1e90ff","#ff6347","#7b68ee","#00fa9a","#ffd700","#6699FF","#ff6666","#3cb371","#b8860b","#30e0e0"],xAxis:{type:"category",boundaryGap:!1,data:t,splitLine:{show:!1,lineStyle:{color:["#dedede"]}},axisLine:{lineStyle:{color:"#d2d2d2",width:1}}},dataZoom:[{type:"slider",xAxisIndex:0,start:0,end:100}],yAxis:{type:"value",splitLine:{show:!0,lineStyle:{color:["#aaa"]}},axisLine:{lineStyle:{color:"#d2d2d2",width:1}}},series:e}},loadTableData:function(t){var e=this;t&&(this.pageInfo.pageIndex=1);var a={1:this.$t("common.text.run"),0:this.$t("common.text.stop")};Object(c.w)({pageNumber:this.pageInfo.pageIndex,pageSize:this.pageInfo.pageSize,name:this.search.name,deviceStatus:this.search.status}).then(function(t){e.tableData=(t.data.result||[]).map(function(t){return s()({},t,{deviceStatusName:a[t.deviceStatus]})}),e.tableData.length>0&&(e.deviceId=e.tableData[0].id),e.pageInfo.totalElements=t.data.totalElements||0}).finally(function(){})},onPaginationChange:function(t){this.pageInfo.pageIndex=t,this.loadTableData(!1)},onPaginationSizeChange:function(t){this.pageInfo.pageSize=t,this.loadTableData(!0)}},mounted:function(){this.loadTableData(!0)}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"real-time-statistics view-list"},[a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("div",{staticClass:"container-box"},[a("div",{staticClass:"left"},[a("div",{staticClass:"left-title"},[a("Icon",{staticClass:"icon",staticStyle:{"z-index":"99"},attrs:{type:"md-search"},on:{click:t.loadTableData}}),t._v(" "),a("Input",{staticClass:"serch-input",attrs:{maxlength:50,placeholder:"请输入设备名称/编码"},on:{"on-enter":t.loadTableData},model:{value:t.search.name,callback:function(e){t.$set(t.search,"name",e)},expression:"search.name"}})],1),t._v(" "),a("div",{staticClass:"left-box"},t._l(t.tableData,function(e,i){return a("li",{class:t.clicked===i?"active":"",on:{click:function(a){t.clickLi(e,i)}}},[a("div",{staticClass:"li-title"},[a("div",{staticClass:"li-left",attrs:{title:e.deviceName.length>10?e.deviceName:""}},[t._v("\n                "+t._s(e.deviceName)+"\n              ")]),t._v(" "),a("div",{staticClass:"li-right",class:1==e.deviceStatus?"green":"red"},[t._v("\n                "+t._s(e.deviceStatusName)+"\n              ")])]),t._v(" "),a("div",{staticClass:"li-content"},[a("div",{staticClass:"li-code"},[a("span",[t._v(" "+t._s(t.$t("common.text.device_code"))+"：")]),a("span",{staticClass:"title",attrs:{title:e.deviceCode.length>15?e.deviceCode:""}},[t._v(t._s(e.deviceCode))])]),t._v(" "),a("div",{staticClass:"li-code"},[a("span",[t._v(t._s(t.$t("common.text.device_model"))+"：")]),a("span",{staticClass:"title",attrs:{title:e.modelName.length>15?e.modelName:""}},[t._v(t._s(e.modelName))])])])])}),0)]),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"right-title"},[t._v("选择数据项:")]),t._v(" "),a("div",{staticClass:"right-box"},[a("div",{staticClass:"item-list"},t._l(t.realData,function(e){return a("div",{key:e.itemId,staticClass:"item",class:t.currentId===e.itemId?"item-active":"",on:{click:function(a){t.checkItemId(e)}}},[a("div",{staticClass:"item-top"},[t._v(t._s(e.itemName))]),t._v(" "),a("div",{staticClass:"item-bottom"},[a("div",{staticStyle:{color:"#fff","word-break":"break-all",overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"1"}},[t._v(t._s(e.alias))])])])}),0)]),t._v(" "),a("div",{staticClass:"chart-title"},[a("DatePicker",{staticClass:"real-time-data",staticStyle:{width:"380px","margin-right":"20px"},attrs:{type:"datetimerange",placeholder:"日期范围:起始时间                       ~       截止时间"},model:{value:t.rangeTime,callback:function(e){t.rangeTime=e},expression:"rangeTime"}}),t._v(" "),a("Button",{attrs:{type:"default",loading:t.pageInfo.loading},on:{click:t.loadLineData}},[a("span",{staticClass:"iconfont icon-chazhao"})])],1),t._v(" "),t.chartOption!=={}?a("div",{staticClass:"chart-box"},[a("ChartBase",{attrs:{id:"lineEChart",options:t.chartOption}})],1):t._e()])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header-sub"},[e("div",{staticClass:"title"},[e("div",{staticClass:"breadcrumb-item-link"},[this._v("历史数据统计分析")])])])}]};var m=a("VU/8")(d,r,!1,function(t){a("1I6r")},"data-v-5ad2d77b",null).exports;e.default=m}});
//# sourceMappingURL=35.c0f326e9b4ade1af7e6c.js.map