webpackJsonp([19],{BbwF:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),l=a.n(i),n=a("Dd8w"),o=a.n(n),s=a("526/"),r=a("jpo7"),c=a("G8pB"),d=a("GUlH"),u=a("xV2B"),f={components:{StatusSelect:s.a,LaboratoryList:r.a,customDrawer:c.a},data:function(){var e=this;return{search:{errorType:"",errorDesc:"",deviceName:""},pageInfo:{loading:!1,pageIndex:1,pageSize:10,totalElements:30},tableData:[],maxlength:50,selectLocation:"",tableColumns:[{title:"设备名称",key:"deviceName",align:"left"},{title:"设备编号",key:"deviceCode",align:"left",width:120},{title:"故障类型",key:"errorType",align:"left",width:120},{title:"故障等级",key:"malLevel",align:"left",width:100},{title:"故障内容",key:"errorDesc",align:"left",ellipsis:!0,tooltip:!0},{title:"测点名称",key:"itemCode",align:"left",width:100},{title:"测点值",key:"itemValue",align:"left",width:100},{title:"报警时间",key:"alertTime",align:"left"},{title:"操作",key:"action",align:"left",render:function(t,a){return t("div",[t("span",{class:"primary",style:{marginLeft:0,color:"#0084FF"},on:{click:function(){e.goDetail(a.row,1)}}},"故障树诊断"),t("span",{class:"primary",style:{marginLeft:0,color:"#6EAD16"},on:{click:function(){e.goDetail(a.row,2)}}},"模型诊断")])}},{title:"诊断结果",key:"result",align:"left",render:function(e,t){return e("div",[e("Tooltip",{props:{placement:"top"},style:{height:"fit-content"}},[e("span",{style:{display:"inline-block",width:.9*t.column._width+"px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},t.row.result),e("span",{slot:"content",style:{whiteSpace:"normal",wordBreak:"break-all"}},t.row.result)])])}}],currentIndex:0,title:"",formList:[{label:"设备名称",type:"input",value:"deviceName"},{label:"设备类型",type:"select",value:"deviceType",data:[]},{label:"设备型号",type:"select",value:"deviceModel",data:[]},{label:"设备编码",type:"input",value:"deviceCode",data:[]},{label:"坐标",type:"locationSelect",value:"addrCode",placeholder:"请选择坐标"},{label:"父级设备",type:"select",value:"parentDeviceId",placeholder:"请选择父级设备",data:[]},{label:"控制场景",value:"deviceControlMode",type:"radio",data:[{name:"单机FCU控制",value:"SINGLE_FCU"},{name:"整机FCU控制",value:"ALL_FCU"},{name:"PCS控制",value:"PCS"},{name:"电池控制",value:"BATTERY"}]}],formValue:{},formValidate:{deviceName:[{required:!0,message:"设备名称不能为空"}],deviceType:[{required:!0,message:"设备类型不能为空"}],deviceModel:[{required:!0,message:"设备型号不能为空"}],deviceCode:[{required:!0,message:"设备编码不能为空"}]},type:""}},methods:{selectTree:function(e){this.formValue.addr=e},getlocation:function(e){this.formValue.longitude=e.lng,this.formValue.latitude=e.lat},getType:function(){},loadTableData:function(){var e=this,t=this.pageInfo,a=t.pageSize,i=t.pageIndex;this.pageInfo.loading=!0,Object(u.C)(o()({pageSize:a,pageNumber:i},this.search)).then(function(t){var a=t.code,i=t.data;e.pageInfo.loading=!1,200===a&&(e.tableData=i.result,e.pageInfo.totalElements=i.totalElements)})},goDetail:function(e,t){1===t?this.$router.push({path:"/health-detail",query:{treeId:e.treeId,deviceName:e.deviceName,dataId:e.id}}):this.$router.push({path:"/model-detail",query:{treeId:e.treeId,deviceName:e.deviceName,dataId:e.id}})},showDrawer:function(e,t){var a=this;if("delete"!==e){if("add"===e)this.title="新建设备",this.formValue={},this.selectLocation="119.209927,36.725914",this.formValue.longitude="119.209927",this.formValue.latitude="36.725914";else{var i=JSON.parse(l()(t));this.title="编辑设备",this.formValue=i,this.formValue.deviceType=i.deviceTypeId,this.formValue.parentDeviceId=Number(i.parentDeviceId),i.longitude&&i.latitude?this.selectLocation=i.longitude+","+i.latitude:(this.selectLocation="119.209927,36.725914",this.formValue.longitude="119.209927",this.formValue.latitude="36.725914")}this.type=e,this.$refs.drawer.open()}else this.$Modal.confirm({title:this.$t("common.text.prompt"),width:this.$flexible(450),content:this.$t("common.text.confirm_title",{name:"设备名称"})+"["+t.deviceName+"]的设备吗?",onOk:function(){Object(d.b)({id:t.id}).then(function(e){200===e.code?(a.$Message.success(e.msg),a.loadTableData()):a.$Message.warning(e.msg)},function(e){a.$Message.warning(e.msg)})}})},onRowClick:function(e){},onPaginationChange:function(e){this.pageInfo.pageIndex=e,this.loadTableData(!1)},onPaginationSizeChange:function(e){this.pageInfo.pageSize=e,this.loadTableData(!0)},rowClassName:function(e,t){if(e.id==this.currentIndex)return"demo-table-info-row"},confirm:function(){var e=this;console.log(this.formValue),this.formValue.state=this.formValue.deviceStatus,"edit"===this.type?Object(d.d)(o()({},this.formValue)).then(function(t){var a=t.code,i=t.msg;200===a?(e.$Message.success(e.$t("common.message.edit_success")),e.loadTableData(),e.$refs.drawer.close(),e.getType()):e.$Message.warning(i)}):Object(d.a)(o()({},this.formValue)).then(function(t){var a=t.code,i=t.msg;200===a?(e.$Message.success(e.$t("common.message.add_success")),e.loadTableData(),e.getType(),e.$refs.drawer.close()):e.$Message.warning(i)})}},mounted:function(){this.loadTableData(),this.getType()}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list"},[a("div",{staticClass:"content"},[e._m(0),e._v(" "),a("div",{staticClass:"filter-search"},[a("div",{staticClass:"filter-search-left"},[a("div",{staticClass:"filter-input mr-12"},[a("Input",{attrs:{placeholder:"请输入设备名称",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.loadTableData(t):null}},model:{value:e.search.deviceName,callback:function(t){e.$set(e.search,"deviceName",t)},expression:"search.deviceName"}})],1),e._v(" "),a("div",{staticClass:"filter-input mr-12"},[a("Input",{attrs:{placeholder:"请输入故障类型",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.loadTableData(t):null}},model:{value:e.search.errorType,callback:function(t){e.$set(e.search,"errorType",t)},expression:"search.errorType"}})],1),e._v(" "),a("div",{staticClass:"filter-input mr-12"},[a("Input",{attrs:{placeholder:"请输入故障内容",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.loadTableData(t):null}},model:{value:e.search.errorDesc,callback:function(t){e.$set(e.search,"errorDesc",t)},expression:"search.errorDesc"}})],1),e._v(" "),a("div",{staticClass:"filter-btn"},[a("Button",{staticClass:"search-btn",attrs:{type:"default"},on:{click:e.loadTableData}},[a("span",{staticClass:"iconfont icon-chazhao"})])],1)])]),e._v(" "),a("div",{staticClass:"user-table"},[a("Table",{staticClass:"m-table no-scroll no-border",staticStyle:{"min-height":"600px"},attrs:{stripe:"",loading:e.pageInfo.loading,columns:e.tableColumns,"row-class-name":e.rowClassName,data:e.tableData},on:{"on-row-click":e.onRowClick}})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{current:e.pageInfo.pageIndex,"page-size":e.pageInfo.pageSize,total:e.pageInfo.totalElements,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.onPaginationChange,"on-page-size-change":e.onPaginationSizeChange}})],1),e._v(" "),a("custom-drawer",{ref:"drawer",attrs:{title:e.title,formValidate:e.formValidate,formList:e.formList,selectLocation:e.selectLocation},on:{selectTree:e.selectTree,getlocation:e.getlocation,confirm:e.confirm},model:{value:e.formValue,callback:function(t){e.formValue=t},expression:"formValue"}})],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header-sub"},[t("div",{staticClass:"title"},[t("div",{staticClass:"breadcrumb-item-link"},[this._v("健康诊断")]),this._v(" "),t("span",{staticClass:"empty"})])])}]};var p=a("VU/8")(f,m,!1,function(e){a("bNtG")},"data-v-4202eac2",null).exports;t.default=p},GUlH:function(e,t,a){"use strict";a.d(t,"c",function(){return n}),a.d(t,"d",function(){return o}),a.d(t,"b",function(){return s}),a.d(t,"a",function(){return r});var i=a("2aIq"),l=(a.n(i),a("xXZE")),n=function(e){return l.a.request({url:"/order/getDevice",params:e,method:"get"})},o=function(e){return l.a.request({url:"/device/editDevice",data:e,method:"post"})},s=function(e){return l.a.request({url:"/device/delDevice",data:e,method:"post"})},r=function(e){return l.a.request({url:"/device/addDevice",data:e,method:"post"})}},bNtG:function(e,t){}});
//# sourceMappingURL=19.1d6e1164c62574ca1b96.js.map