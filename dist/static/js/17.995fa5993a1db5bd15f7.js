webpackJsonp([17],{KG0Y:function(e,t){},XgeV:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Dd8w"),i=s.n(a),n=s("//Fk"),o=s.n(n),r=s("xXZE"),l=s("TVG1"),c=r.a.baseUrl+"/file/uploadFile",g={name:"simple-img-upload",i18n_prefix:"component.form-img-upload",data:function(){return{uploadUrl:c,uploadHeaders:{token:Object(l.g)()}}},props:{value:{type:String}},model:{prop:"value",event:"on-change"},methods:{deleteFile:function(e,t){var s=[].concat(this.value||[]);s.splice(t,1),this.$emit("on-change",s)},beforeUpload:function(e){},onFileProgress:function(e,t,s){this.$emit("on-progress",t)},onUploadSuccess:function(e,t,s){200==e.code?(this.$emit("on-success",t),this.$emit("on-change",e.data.fileUrl),this.$emit("on-selection-change",e.data)):this.$emit("on-error",t)},onUploadError:function(e,t,s){this.$emit("on-error",t),this.$Message.error(this.$t_p("upload_fail"))}}},v={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"simple-img-upload"},[t("Upload",{ref:"upload",staticClass:"upload",attrs:{headers:this.uploadHeaders,format:["jpg","jpeg","png"],"max-size":2048,"show-upload-list":!1,name:"file",data:{fileType:1},"before-upload":this.beforeUpload,"on-progress":this.onFileProgress,"on-success":this.onUploadSuccess,"on-error":this.onUploadError,action:this.uploadUrl}},[this._t("default")],2)],1)},staticRenderFns:[]};var d=s("VU/8")(g,v,!1,function(e){s("YJEy")},"data-v-0b82584b",null).exports,m=s("2aIq"),p=s.n(m),_={name:"platform-setting",i18n_prefix:"page.system-setting.platform-setting",components:{SimpleImgUpload:d},data:function(){return{form:{},formPsw:{sourcePasswd:"",newPasswd:"",verifyPasswd:""},aa:11,tabs:[{name:"site",title:this.$t_p("site_configuration")},{name:"banner",title:this.$t_p("banner_configuration")}],siteSetting:{browserLogo:"",loginLogo:"",managerLogo:""},logos:{browserLogo:"",loginLogo:"",managerLogo:""},siteSetting1:{banner1:"",banner2:"",banner3:"",banner4:"",banner5:""},banners:{banner1:"",banner2:"",banner3:"",banner4:"",banner5:""},userRules:{},isBtnLoading:!1}},methods:{handleReset:function(e){this.$refs[e].resetFields()},savePasswd:function(){var e=this;this.isBtnLoading1=!0,this.checkPasForm().then(function(){EidtPasswd(e.formPsw).then(function(t){e.isBtnLoading1=!1,e.$Message.success(t.msg)},function(t){e.$Message.warning(t.msg)})},function(t,s){e.isBtnLoading1=!1})},checkPasForm:function(){var e=this;return new o.a(function(t,s){e.$refs.pasForm.validate(function(e,a){e?t():s(e,a)})})},selectTab:function(e){this.$router.push({name:this.$route.name,params:this.$route.params,query:i()({},this.$route.query,{tab:e})})},checkInfoRefresh:function(e){this.currentTab},onDeviceModelChange:function(e){for(var t in this.siteSetting)this.siteSetting[t]===e.fileUrl&&(this.logos[t]=e.id)},onDeviceModelChange1:function(e){for(var t in this.siteSetting1)this.siteSetting1[t]===e.fileUrl&&(this.banners[t]=e.id)},getData:function(){var e=this;(function(e){p()(e);return r.a.request({url:"/email/getEmailConfig",params:{},method:"get"})})({}).then(function(t){e.form="[object Object]"===Object.prototype.toString.call(t.data)?t.data:{}}),function(e){p()(e);return r.a.request({url:"/logo/getLogoConfig",params:{},method:"get"})}({}).then(function(t){e.siteSetting.browserLogo=t.data.browserLogo,e.siteSetting.loginLogo=t.data.loginLogo,e.siteSetting.managerLogo=t.data.managerLogo}),function(e){p()(e);return r.a.request({url:"/logo/getBannerConfig",params:{},method:"get"})}({}).then(function(t){e.siteSetting1.banner1=t.data.banner1Url,e.siteSetting1.banner2=t.data.banner2Url,e.siteSetting1.banner3=t.data.banner3Url,e.siteSetting1.banner4=t.data.banner4Url,e.siteSetting1.banner5=t.data.banner5Url})},saveLogo:function(){var e,t,s=this;(e=this.logos,t={loginLogo:e.loginLogo,managerLogo:e.managerLogo,browserLogo:e.browserLogo},r.a.request({url:"/logo/saveLogoConfig",data:t,method:"post"})).then(function(){s.$Message.success(s.$t("common.message.save_success"))},function(){s.$Message.warning(s.$t("common.message.save_fail"))})},saveBanner:function(){var e,t,s=this;(e=this.banners,t={banner1:e.banner1,banner2:e.banner2,banner3:e.banner3,banner4:e.banner4,banner5:e.banner5},r.a.request({url:"/logo/saveBannerConfig",data:t,method:"post"})).then(function(){s.$Message.success(s.$t("common.message.save_success"))},function(){s.$Message.warning(s.$t("common.message.save_fail"))})},saveClick:function(){var e,t,s=this;(e=this.form,t={serverUrl:e.serverUrl,verifyUser:e.verifyUser,verifyPasswd:e.verifyPasswd,verifyName:e.verifyName},r.a.request({url:"/email/saveEmailConfig",data:t,method:"post"})).then(function(e){s.$Message.success(s.$t_p("email_config_success"))},function(){s.$Message.warning(s.$t_p("email_config_fail"))})}},computed:{currentTab:function(){return["0","1","2","3","4","5","6","7","8"].includes(this.$route.query.tab)?this.$route.query.tab:"0"}},watch:{currentTab:function(){this.checkInfoRefresh(!0)}},mounted:function(){this.getData()}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"platform-setting"},[e._m(0),e._v(" "),s("div",{staticClass:"d-content"},[s("div",{staticClass:"tab-flat"},[s("a",{class:{active:"0"===e.currentTab},on:{click:function(t){e.selectTab("0")}}},[e._v("站点配置")]),e._v(" "),s("a",{class:{active:"1"===e.currentTab},on:{click:function(t){e.selectTab("1")}}},[e._v("邮件配置")]),e._v(" "),s("a",{class:{active:"3"===e.currentTab},on:{click:function(t){e.selectTab("3")}}},[e._v("微信Banner设置")])]),e._v(" "),s("div",{staticClass:"tabs"},[s("Tabs",{staticClass:"no-header tabs-inner",attrs:{value:e.currentTab}},[s("TabPane",{staticClass:"panel-table",attrs:{name:"0"}},[s("div",{staticClass:"tab-box"},[s("div",{staticClass:"setting-box"},[s("div",{staticClass:"setting-item"},[s("div",{staticClass:"desc"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteSetting.loginLogo,expression:"!siteSetting.loginLogo"}],staticClass:"name"},[e._v("image")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.siteSetting.loginLogo,expression:"siteSetting.loginLogo"}],staticClass:"img-display",style:{backgroundImage:"url('"+e.siteSetting.loginLogo+"')"}}),e._v(" "),e.$hasAccess("platform.edit")?s("SimpleImgUpload",{staticClass:"input-log",on:{"on-selection-change":e.onDeviceModelChange},model:{value:e.siteSetting.loginLogo,callback:function(t){e.$set(e.siteSetting,"loginLogo",t)},expression:"siteSetting.loginLogo"}},[s("div",{staticClass:"img-add"},[e._v(e._s(e.$t_p("customize")))])]):e._e()],1),e._v(" "),s("div",{staticClass:"more"},[s("h4",[e._v(e._s(e.$t_p("login_logo")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("config_format")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("login_big")))])])])]),e._v(" "),s("div",{staticClass:"setting-box"},[s("div",{staticClass:"setting-item"},[s("div",{staticClass:"desc"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteSetting.managerLogo,expression:"!siteSetting.managerLogo"}],staticClass:"name"},[e._v("image")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.siteSetting.managerLogo,expression:"siteSetting.managerLogo"}],staticClass:"img-display",style:{backgroundImage:"url('"+e.siteSetting.managerLogo+"')"}}),e._v(" "),s("div",{staticClass:"input"},[e.$hasAccess("platform.edit")?s("SimpleImgUpload",{staticClass:"input-log",on:{"on-selection-change":e.onDeviceModelChange},model:{value:e.siteSetting.managerLogo,callback:function(t){e.$set(e.siteSetting,"managerLogo",t)},expression:"siteSetting.managerLogo"}},[s("div",{staticClass:"img-add"},[e._v(e._s(e.$t_p("customize")))])]):e._e()],1)]),e._v(" "),s("div",{staticClass:"more"},[s("h4",[e._v(e._s(e.$t_p("backstage_logo")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("config_format")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("backstage_big")))])])])]),e._v(" "),s("div",{staticClass:"setting-box"},[s("div",{staticClass:"setting-item"},[s("div",{staticClass:"desc"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteSetting.browserLogo,expression:"!siteSetting.browserLogo"}],staticClass:"name"},[e._v("image")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.siteSetting.browserLogo,expression:"siteSetting.browserLogo"}],staticClass:"img-display",style:{backgroundImage:"url('"+e.siteSetting.browserLogo+"')"}}),e._v(" "),s("div",{staticClass:"input"},[e.$hasAccess("platform.edit")?s("SimpleImgUpload",{staticClass:"input-log",on:{"on-selection-change":e.onDeviceModelChange},model:{value:e.siteSetting.browserLogo,callback:function(t){e.$set(e.siteSetting,"browserLogo",t)},expression:"siteSetting.browserLogo"}},[s("div",{staticClass:"img-add"},[e._v(e._s(e.$t_p("customize")))])]):e._e()],1)]),e._v(" "),s("div",{staticClass:"more"},[s("h4",[e._v(e._s(e.$t_p("browser_logo")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("config_format")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("browser_big")))])])])])]),e._v(" "),s("div",{staticClass:"info-line"}),e._v(" "),e.$hasAccess("platform.edit")?s("div",{staticClass:"ops"},[s("Button",{attrs:{type:"primary"},on:{click:e.saveLogo}},[e._v(e._s(e.$t("common.message.save")))])],1):e._e()]),e._v(" "),s("TabPane",{staticClass:"panel-table",attrs:{name:"1"}},[s("Form",{ref:"pasForm",attrs:{model:e.formPsw,rules:e.userRules,"label-width":e.$flexible(10)}},[s("FormItem",{staticClass:"setting-item",attrs:{prop:"sourcePasswd"}},[s("div",{staticClass:"desc"},[s("div",{staticClass:"name"},[s("span",{staticClass:"red",staticStyle:{color:"red"}},[e._v("*")]),e._v("SMTP服务器地址\n                ")])]),e._v(" "),s("div",{staticClass:"input"},[s("Input",{staticClass:"input-txt",attrs:{type:"password",placeholder:"请填写服务器使用的邮箱地址，例如：smtp.qq.com",disabled:!e.$hasAccess("per.edit")},model:{value:e.formPsw.sourcePasswd,callback:function(t){e.$set(e.formPsw,"sourcePasswd",t)},expression:"formPsw.sourcePasswd"}})],1)]),e._v(" "),s("FormItem",{staticClass:"setting-item",attrs:{prop:"newPasswd"}},[s("div",{staticClass:"desc"},[s("div",{staticClass:"name"},[s("span",{staticClass:"red",staticStyle:{color:"red"}},[e._v("*")]),e._v("SMTP验证用户\n                ")])]),e._v(" "),s("div",{staticClass:"input"},[s("Input",{staticClass:"input-txt",attrs:{maxlength:16,minlength:6,type:"password",disabled:!e.$hasAccess("per.edit"),placeholder:"请填写使用邮箱地址，例如：abc@.qq.com"},model:{value:e.formPsw.newPasswd,callback:function(t){e.$set(e.formPsw,"newPasswd",t)},expression:"formPsw.newPasswd"}})],1)]),e._v(" "),s("FormItem",{staticClass:"setting-item",attrs:{prop:"verifyPasswd"}},[s("div",{staticClass:"desc"},[s("div",{staticClass:"name"},[s("span",{staticClass:"red",staticStyle:{color:"red"}},[e._v("*")]),e._v("SMTP验证密码\n                ")])]),e._v(" "),s("div",{staticClass:"input"},[s("Input",{staticClass:"input-txt",attrs:{type:"password",maxlength:16,minlength:6,disabled:!e.$hasAccess("per.edit"),placeholder:"请填写邮箱的登录密码"},model:{value:e.formPsw.verifyPasswd,callback:function(t){e.$set(e.formPsw,"verifyPasswd",t)},expression:"formPsw.verifyPasswd"}})],1)]),e._v(" "),s("FormItem",{staticClass:"setting-item",attrs:{prop:"verifyPasswd"}},[s("div",{staticClass:"desc"},[s("div",{staticClass:"name"},[s("span",{staticClass:"red",staticStyle:{color:"red"}},[e._v("*")]),e._v("SMTP发件人名称\n                ")])]),e._v(" "),s("div",{staticClass:"input"},[s("Input",{staticClass:"input-txt",attrs:{type:"password",maxlength:16,minlength:6,disabled:!e.$hasAccess("per.edit"),placeholder:"请填写邮箱发送的发件人的名称，限制在32个字符以内"},model:{value:e.formPsw.verifyPasswd,callback:function(t){e.$set(e.formPsw,"verifyPasswd",t)},expression:"formPsw.verifyPasswd"}})],1)]),e._v(" "),s("div",{staticClass:"info-line"}),e._v(" "),e.$hasAccess("per.edit")?s("div",{staticClass:"ops"},[s("Button",{attrs:{type:"primary",loading:e.isBtnLoading}},[e._v(e._s(e.$t("common.message.save")))])],1):e._e()],1)],1),e._v(" "),s("TabPane",{staticClass:"panel-table",attrs:{name:"3"}},[s("div",{staticClass:"tab-box"},[s("div",{staticClass:"setting-box setting-banner"},[s("div",{staticClass:"setting-item"},[s("div",{staticClass:"desc"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteSetting1.banner1,expression:"!siteSetting1.banner1"}],staticClass:"name"},[e._v("image")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.siteSetting1.banner1,expression:"siteSetting1.banner1"}],staticClass:"img-display",style:{backgroundImage:"url('"+e.siteSetting1.banner1+"')"}}),e._v(" "),e.$hasAccess("platform.edit")?s("SimpleImgUpload",{staticClass:"input-log",on:{"on-selection-change":e.onDeviceModelChange1},model:{value:e.siteSetting1.banner1,callback:function(t){e.$set(e.siteSetting1,"banner1",t)},expression:"siteSetting1.banner1"}},[s("div",{staticClass:"img-add"},[e._v(e._s(e.$t_p("customize")))])]):e._e()],1),e._v(" "),s("div",{staticClass:"more"},[s("h4",[e._v("banner1")]),e._v(" "),s("p",[e._v(e._s(e.$t_p("config_format")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("login_big")))])])])]),e._v(" "),s("div",{staticClass:"setting-box setting-banner"},[s("div",{staticClass:"setting-item"},[s("div",{staticClass:"desc"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteSetting1.banner2,expression:"!siteSetting1.banner2"}],staticClass:"name"},[e._v("image")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.siteSetting1.banner2,expression:"siteSetting1.banner2"}],staticClass:"img-display",style:{backgroundImage:"url('"+e.siteSetting1.banner2+"')"}}),e._v(" "),s("div",{staticClass:"input"},[e.$hasAccess("platform.edit")?s("SimpleImgUpload",{staticClass:"input-log",on:{"on-selection-change":e.onDeviceModelChange1},model:{value:e.siteSetting1.banner2,callback:function(t){e.$set(e.siteSetting1,"banner2",t)},expression:"siteSetting1.banner2"}},[s("div",{staticClass:"img-add"},[e._v(e._s(e.$t_p("customize")))])]):e._e()],1)]),e._v(" "),s("div",{staticClass:"more"},[s("h4",[e._v("banner2")]),e._v(" "),s("p",[e._v(e._s(e.$t_p("config_format")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("login_big")))])])])]),e._v(" "),s("div",{staticClass:"setting-box setting-banner"},[s("div",{staticClass:"setting-item"},[s("div",{staticClass:"desc"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteSetting1.banner3,expression:"!siteSetting1.banner3"}],staticClass:"name"},[e._v("image")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.siteSetting1.banner3,expression:"siteSetting1.banner3"}],staticClass:"img-display",style:{backgroundImage:"url('"+e.siteSetting1.banner3+"')"}}),e._v(" "),s("div",{staticClass:"input"},[e.$hasAccess("platform.edit")?s("SimpleImgUpload",{staticClass:"input-log",on:{"on-selection-change":e.onDeviceModelChange1},model:{value:e.siteSetting1.banner3,callback:function(t){e.$set(e.siteSetting1,"banner3",t)},expression:"siteSetting1.banner3"}},[s("div",{staticClass:"img-add"},[e._v(e._s(e.$t_p("customize")))])]):e._e()],1)]),e._v(" "),s("div",{staticClass:"more"},[s("h4",[e._v("banner3")]),e._v(" "),s("p",[e._v(e._s(e.$t_p("config_format")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("login_big")))])])])]),e._v(" "),s("div",{staticClass:"setting-box setting-banner"},[s("div",{staticClass:"setting-item"},[s("div",{staticClass:"desc"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteSetting1.banner4,expression:"!siteSetting1.banner4"}],staticClass:"name"},[e._v("image")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.siteSetting1.banner4,expression:"siteSetting1.banner4"}],staticClass:"img-display",style:{backgroundImage:"url('"+e.siteSetting1.banner4+"')"}}),e._v(" "),s("div",{staticClass:"input"},[e.$hasAccess("platform.edit")?s("SimpleImgUpload",{staticClass:"input-log",on:{"on-selection-change":e.onDeviceModelChange1},model:{value:e.siteSetting1.banner4,callback:function(t){e.$set(e.siteSetting1,"banner4",t)},expression:"siteSetting1.banner4"}},[s("div",{staticClass:"img-add"},[e._v(e._s(e.$t_p("customize")))])]):e._e()],1)]),e._v(" "),s("div",{staticClass:"more"},[s("h4",[e._v("banner4")]),e._v(" "),s("p",[e._v(e._s(e.$t_p("config_format")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("login_big")))])])])]),e._v(" "),s("div",{staticClass:"setting-box setting-banner"},[s("div",{staticClass:"setting-item"},[s("div",{staticClass:"desc"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.siteSetting1.banner5,expression:"!siteSetting1.banner5"}],staticClass:"name"},[e._v("image")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.siteSetting1.banner5,expression:"siteSetting1.banner5"}],staticClass:"img-display",style:{backgroundImage:"url('"+e.siteSetting1.banner5+"')"}}),e._v(" "),s("div",{staticClass:"input"},[e.$hasAccess("platform.edit")?s("SimpleImgUpload",{staticClass:"input-log",on:{"on-selection-change":e.onDeviceModelChange1},model:{value:e.siteSetting1.banner5,callback:function(t){e.$set(e.siteSetting1,"banner5",t)},expression:"siteSetting1.banner5"}},[s("div",{staticClass:"img-add"},[e._v(e._s(e.$t_p("customize")))])]):e._e()],1)]),e._v(" "),s("div",{staticClass:"more"},[s("h4",[e._v("banner5")]),e._v(" "),s("p",[e._v(e._s(e.$t_p("config_format")))]),e._v(" "),s("p",[e._v(e._s(e.$t_p("login_big")))])])])])]),e._v(" "),s("div",{staticClass:"info-line"}),e._v(" "),e.$hasAccess("platform.edit")?s("div",{staticClass:"ops"},[s("Button",{attrs:{type:"primary"},on:{click:e.saveBanner}},[e._v(e._s(e.$t("common.message.save")))])],1):e._e()])],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header-sub"},[t("div",{staticClass:"title"},[t("div",{staticClass:"breadcrumb-item-link"},[this._v("平台设置")]),this._v(" "),t("span",{staticClass:"empty"})])])}]};var b=s("VU/8")(_,u,!1,function(e){s("KG0Y")},"data-v-0d8f09e4",null).exports;t.default=b},YJEy:function(e,t){}});
//# sourceMappingURL=17.995fa5993a1db5bd15f7.js.map