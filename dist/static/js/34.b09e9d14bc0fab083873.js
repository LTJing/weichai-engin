webpackJsonp([34],{"+QBy":function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("//Fk"),r=e.n(a),i=e("Dd8w"),n=e.n(i),o={name:"user-setting",i18n_prefix:"page.system-setting.user-setting",components:{},data:function(){var s=this;return{btnDistable:!1,form:{userName:this.$store.state.user.userName,fullName:this.$store.state.user.fullName,phoneNumber:this.$store.state.user.phoneNumber},formNew:{},formPsw:{sourcePasswd:"",newPasswd:"",verifyPasswd:""},isBtnLoading:!1,isBtnLoading1:!1,userRules:{userName:[{required:!0,message:this.$t_p("user_name_rule"),trigger:"blur"}],fullName:[{required:!0,message:this.$t_p("name_rule"),trigger:"blur"}],sourcePasswd:[{required:!0,message:this.$t_p("old_password_rule"),trigger:"blur"}],newPasswd:[{validator:function(t,e,a){/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/.test(e)?e==s.formPsw.sourcePasswd?a(s.$t_p("same_password_rule")):a():a(s.$t_p("new_password_rule"))},trigger:"blur"}],verifyPasswd:[{validator:function(t,e,a){/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/.test(e)?e!=s.formPsw.newPasswd?a(s.$t_p("same_password_rule")):a():a(s.$t_p("new_password_rule"))},trigger:"blur"}],phoneNumber:[{validator:function(t,e,a){if(e){/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$|400[0-9]{7}|^800[0-9]{7}|^0\d{2,3}-?\d{7,8}$/.test(e)?a():a(s.$t_p("phone_number_rule"))}else a()},trigger:"blur"}]},baseSetting:{loginName:"",userName:"",tel:""}}},methods:{selectTab:function(s){this.$router.push({name:this.$route.name,params:this.$route.params,query:n()({},this.$route.query,{tab:s})})},checkInfoRefresh:function(s){this.currentTab},handleReset:function(s){this.$refs[s].resetFields()},savePasswd:function(){var s=this;this.isBtnLoading1=!0,this.checkPasForm().then(function(){EidtPasswd(s.formPsw).then(function(t){s.isBtnLoading1=!1,s.$Message.success(t.msg)},function(t){s.$Message.warning(t.msg)})},function(t,e){s.isBtnLoading1=!1})},checkPasForm:function(){var s=this;return new r.a(function(t,e){s.$refs.pasForm.validate(function(s,a){s?t():e(s,a)})})},checkRoleFrom:function(){var s=this;return new r.a(function(t,e){s.$refs.userForm.validate(function(s,a){s?t():e(s,a)})})},saveClick:function(){var s=this,t=this;this.checkRoleFrom().then(function(){EditBasic(s.form).then(function(e){s.isBtnLoading=!1,s.$Message.success(s.$t("common.message.edit_success")),s.$store.dispatch("getUserInfo",{force:!0}).then(function(e){t.form={userName:s.$store.state.user.userName,fullName:s.$store.state.user.fullName,phoneNumber:s.$store.state.user.phoneNumber}})},function(t){1e3===t.code?s.$Message.warning(t.msg):s.$Message.warning(s.$t("common.message.edit_fail"))})},function(t,e){s.isBtnLoading=!1})}},computed:{currentTab:function(){return["0","1","2","3","4","5","6","7","8"].includes(this.$route.query.tab)?this.$route.query.tab:"0"}},watch:{currentTab:function(){this.checkInfoRefresh(!0)}},mounted:function(){}},l={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"user-setting"},[s._m(0),s._v(" "),e("div",{staticClass:"d-content"},[e("div",{staticClass:"tab-flat"},[e("a",{class:{active:"0"===s.currentTab},on:{click:function(t){s.selectTab("0")}}},[s._v("基本信息")]),s._v(" "),e("a",{class:{active:"1"===s.currentTab},on:{click:function(t){s.selectTab("1")}}},[s._v("安全设置")])]),s._v(" "),e("div",{staticClass:"tabs"},[e("Tabs",{staticClass:"no-header tabs-inner",attrs:{value:s.currentTab}},[e("TabPane",{staticClass:"panel-table",attrs:{name:"0"}},[e("Form",{ref:"userForm",attrs:{model:s.form,rules:s.userRules,"label-width":s.$flexible(10)}},[e("FormItem",{staticClass:"setting-item",attrs:{prop:"userName"}},[e("div",{staticClass:"desc"},[e("div",{staticClass:"name"},[e("span",{staticClass:"red",staticStyle:{color:"red"}},[s._v("*")]),s._v(s._s(s.$t_p("user_name"))+"\n                ")])]),s._v(" "),e("div",{staticClass:"input full"},[e("Input",{staticClass:"input-txt",attrs:{type:"text",placeholder:s.$t_p("user_name_placeholder"),disabled:""},model:{value:s.form.userName,callback:function(t){s.$set(s.form,"userName",t)},expression:"form.userName"}})],1)]),s._v(" "),e("FormItem",{staticClass:"setting-item",attrs:{prop:"fullName"}},[e("div",{staticClass:"desc"},[e("div",{staticClass:"name"},[e("span",{staticClass:"red",staticStyle:{color:"red"}},[s._v("*")]),s._v(s._s(s.$t_p("name"))+"\n                ")])]),s._v(" "),e("div",{staticClass:"input full"},[e("Input",{staticClass:"input-txt",attrs:{type:"text",placeholder:s.$t_p("name_placeholder"),disabled:!s.$hasAccess("per.edit")},model:{value:s.form.fullName,callback:function(t){s.$set(s.form,"fullName",t)},expression:"form.fullName"}})],1)]),s._v(" "),e("FormItem",{staticClass:"setting-item",attrs:{prop:"phoneNumber"}},[e("div",{staticClass:"desc"},[e("div",{staticClass:"name"},[s._v(s._s(s.$t_p("phone_number")))])]),s._v(" "),e("div",{staticClass:"input full"},[e("Input",{staticClass:"input-txt",attrs:{type:"text",placeholder:s.$t_p("phone_number_placeholder"),disabled:!s.$hasAccess("per.edit")},model:{value:s.form.phoneNumber,callback:function(t){s.$set(s.form,"phoneNumber",t)},expression:"form.phoneNumber"}})],1)]),s._v(" "),e("div",{staticClass:"info-line"}),s._v(" "),s.$hasAccess("per.edit")?e("div",{staticClass:"ops"},[e("Button",{attrs:{disabled:s.btnDistable},on:{click:function(t){s.handleReset("userForm")}}},[s._v("恢复默认")]),s._v(" "),e("Button",{attrs:{type:"primary",loading:s.isBtnLoading,disabled:s.btnDistable},on:{click:s.saveClick}},[s._v(s._s(s.$t("common.message.save")))])],1):s._e()],1)],1),s._v(" "),e("TabPane",{staticClass:"panel-table",attrs:{name:"1"}},[e("Form",{ref:"pasForm",attrs:{model:s.formPsw,rules:s.userRules,"label-width":s.$flexible(10)}},[e("FormItem",{staticClass:"setting-item",attrs:{prop:"sourcePasswd"}},[e("div",{staticClass:"desc"},[e("div",{staticClass:"name"},[e("span",{staticClass:"red",staticStyle:{color:"red"}},[s._v("*")]),s._v(s._s(s.$t_p("old_password"))+"\n                ")])]),s._v(" "),e("div",{staticClass:"input"},[e("Input",{staticClass:"input-txt",attrs:{type:"password",placeholder:s.$t_p("old_password_placeholder"),disabled:!s.$hasAccess("per.edit")},model:{value:s.formPsw.sourcePasswd,callback:function(t){s.$set(s.formPsw,"sourcePasswd",t)},expression:"formPsw.sourcePasswd"}})],1)]),s._v(" "),e("FormItem",{staticClass:"setting-item",attrs:{prop:"newPasswd"}},[e("div",{staticClass:"desc"},[e("div",{staticClass:"name"},[e("span",{staticClass:"red",staticStyle:{color:"red"}},[s._v("*")]),s._v(s._s(s.$t_p("new_password"))+"\n                ")])]),s._v(" "),e("div",{staticClass:"input"},[e("Input",{staticClass:"input-txt",attrs:{maxlength:16,minlength:6,type:"password",disabled:!s.$hasAccess("per.edit"),placeholder:s.$t_p("new_password_placeholder")},model:{value:s.formPsw.newPasswd,callback:function(t){s.$set(s.formPsw,"newPasswd",t)},expression:"formPsw.newPasswd"}})],1)]),s._v(" "),e("FormItem",{staticClass:"setting-item",attrs:{prop:"verifyPasswd"}},[e("div",{staticClass:"desc"},[e("div",{staticClass:"name"},[e("span",{staticClass:"red",staticStyle:{color:"red"}},[s._v("*")]),s._v(s._s(s.$t_p("confirm_password"))+"\n                ")])]),s._v(" "),e("div",{staticClass:"input"},[e("Input",{staticClass:"input-txt",attrs:{type:"password",maxlength:16,minlength:6,disabled:!s.$hasAccess("per.edit"),placeholder:s.$t_p("confirm_password_placeholder")},model:{value:s.formPsw.verifyPasswd,callback:function(t){s.$set(s.formPsw,"verifyPasswd",t)},expression:"formPsw.verifyPasswd"}})],1)]),s._v(" "),e("div",{staticClass:"info-line"}),s._v(" "),s.$hasAccess("per.edit")?e("div",{staticClass:"ops"},[e("Button",{on:{click:function(t){s.handleReset("pasForm")}}},[s._v("恢复默认")]),s._v(" "),e("Button",{attrs:{type:"primary",loading:s.isBtnLoading},on:{click:s.savePasswd}},[s._v(s._s(s.$t("common.message.save")))])],1):s._e()],1)],1)],1)],1)])])},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"header-sub"},[t("div",{staticClass:"title"},[t("div",{staticClass:"breadcrumb-item-link"},[this._v("个人设置")]),this._v(" "),t("span",{staticClass:"empty"})])])}]};var c=e("VU/8")(o,l,!1,function(s){e("bFvj")},"data-v-84465644",null).exports;t.default=c},bFvj:function(s,t){}});
//# sourceMappingURL=34.b09e9d14bc0fab083873.js.map